-- Create a new database for the dataset
CREATE DATABASE telecom_db;

-- Use the database
USE telecom_db;

-- Create customer_info table
CREATE TABLE telecom_db.customer_info
(
    customer_id UInt32,
    first_name String,
    last_name String,
    email String,
    phone_number String,
    date_of_birth Date,
    address String
) ENGINE = MergeTree()
ORDER BY customer_id;

-- Create service_plans table
CREATE TABLE telecom_db.service_plans
(
    plan_id UInt32,
    plan_name String,
    monthly_cost Decimal(5,2),
    data_limit_gb UInt32,
    voice_minutes UInt32,
    sms_limit UInt32
) ENGINE = MergeTree()
ORDER BY plan_id;

-- Create purchase_info table
CREATE TABLE telecom_db.purchase_info
(
    purchase_id UInt32,
    customer_id UInt32,
    plan_id UInt32,
    purchase_date Date,
    amount_paid Decimal(7,2),
    payment_method String
) ENGINE = MergeTree()
ORDER BY purchase_id;

-- Create call_data_records table
CREATE TABLE telecom_db.call_data_records
(
    call_id UInt32,
    customer_id UInt32,
    start_time DateTime,
    end_time DateTime,
    origin String,
    destination String,
    call_duration UInt32,
    call_cost Decimal(6,2)
) ENGINE = MergeTree()
ORDER BY call_id;

-- Insert sample data into customer_info
INSERT INTO customer_info (first_name, last_name, email, phone_number, date_of_birth, address) VALUES
('Natalie', 'Pierce', 'anthonyhartman@obrien.com', '+1-804-457-5152', '2003-10-29', '8618 Amy Rapids Port Christian, NM 37068'),
('Heather', 'Collins', 'jo31@hotmail.com', '001-452-918-0558x376', '2015-02-05', '866 Cordova Canyon Simpsonberg, MA 77319'),
('Jacqueline', 'Brown', 'christopher56@mccarty.com', '001-065-718-2695x66715', '1947-04-07', '245 Kirk Mountain Suite 538 Kelleytown, NH 27835'),
('Leslie', 'Rodriguez', 'williamsbrandon@russell.net', '(529)676-8492x11758', '1921-05-02', '429 Robert Canyon Port Josephland, PA 14901'),
('Bailey', 'Odom', 'latoya96@gmail.com', '001-635-938-2553x052', '2004-05-03', '6075 Glenn Meadow South Sarah, MD 93195'),
('Amanda', 'Decker', 'kmoyer@yahoo.com', '7906465435', '2012-01-02', '4947 Ryan Village South Benjamin, SC 76206'),
('Matthew', 'Scott', 'ramseyrobert@gmail.com', '367.201.7207', '2002-12-26', '606 Howell Junctions Apt. 825 Autumnside, LA 57603'),
('Matthew', 'Walker', 'qsmith@wright.com', '(094)123-4555x96249', '1986-03-14', '1406 Larsen Drive Richardsside, ID 94509'),
('David', 'Evans', 'bsantos@yahoo.com', '966-670-8447', '1998-09-20', '7201 Moore Village South Justinmouth, AR 87430'),
('Allen', 'Lane', 'johnsonmargaret@coleman.com', '001-729-039-6613x00322', '1969-02-02', '865 Vicki Squares Suite 703 East Anthony, AL 26120'),
('Lauren', 'Smith', 'trujillodavid@yahoo.com', '001-065-128-4586x36112', '2019-07-09', 'Unit 8686 Box 4647 DPO AA 50369'),
('Julia', 'Collins', 'lallen@lynch-johnston.com', '(112)768-9149x25533', '1955-11-22', '756 Fleming Lake Apt. 368 West Tiffany, MI 98038'),
('Gregory', 'Garner', 'elizabeth67@day-blevins.com', '(597)278-2413', '1962-08-03', '4383 Ryan Mount Apt. 195 Lisabury, KY 64144'),
('Luke', 'Jones', 'brianna63@yahoo.com', '(268)333-6988', '1981-11-21', '82767 Schwartz Highway New Sarah, PA 48913'),
('Stacy', 'Walker', 'richardsraymond@hotmail.com', '806.256.7605', '2020-08-11', '32535 Randy Stream New Jacqueline, DE 51950'),
('Lisa', 'Gardner', 'emmagutierrez@yahoo.com', '184-959-4283x42609', '2020-11-29', '47399 Johnson Port Garciahaven, GA 11871'),
('Christopher', 'Myers', 'ccummings@hotmail.com', '+1-202-332-7306x56451', '2001-10-19', '81864 Miller Crescent Davidberg, IL 80672'),
('Lisa', 'Dougherty', 'james94@hotmail.com', '096.179.9323x59114', '2000-02-26', '3406 Jimenez Shoals South Christian, SC 75245'),
('Jennifer', 'Cooley', 'josephwallace@hotmail.com', '001-012-449-2417x0559', '1977-08-27', '8846 Susan Brook New Theresastad, IL 79660'),
('Sophia', 'Hale', 'longzachary@cardenas.org', '8163995235', '1996-02-01', '578 Christopher Ranch Suite 013 Jonathanbury, VA 47727'),
('Edward', 'Garcia', 'dannycrawford@aguilar.com', '(492)439-2384x4089', '1923-08-06', '620 Tyler Prairie Port Devinburgh, KS 42804'),
('Christine', 'Rogers', 'cassieknapp@hotmail.com', '277.949.6635x2376', '2000-01-31', '3157 Ashley Expressway South Leslie, SC 46505'),
('Victoria', 'Lamb', 'ronald35@pope.com', '218-470-7160x9661', '1966-02-28', '400 Welch Route Suite 504 Lake Kelly, KY 15890'),
('James', 'Christensen', 'karencochran@yahoo.com', '(703)457-1650x9541', '2017-02-11', '407 Mckee Trafficway East Leslieshire, AZ 85721'),
('Frank', 'Flores', 'nwilson@smith.info', '147-728-5983x20051', '2015-02-22', '3065 Harris Islands North Brianborough, PA 32374'),
('Jennifer', 'Gutierrez', 'allenvictoria@flowers.biz', '+1-319-053-2492x10662', '1916-09-17', '022 Allen Camp Lindamouth, LA 31565'),
('Angela', 'Carter', 'bryandavila@gmail.com', '001-312-909-0021x36536', '1970-11-07', '7271 Baker Trail Suite 519 Brooksstad, MA 33848'),
('Janice', 'Welch', 'robertmcbride@pratt-williams.com', '(315)402-0971x528', '2021-01-16', '81451 Brown Plains Suite 118 Tamarafurt, FL 98135'),
('David', 'Yates', 'droth@downs-smith.com', '490-219-3440x495', '1924-10-12', '866 Garcia Row New Sheilaport, DE 29513'),
('Kelly', 'Gibson', 'brianmassey@hotmail.com', '618-857-8256', '1930-04-13', 'USNS Anderson FPO AA 32345'),
('Charles', 'Spencer', 'hayesbrittany@gmail.com', '+1-196-765-0838x603', '2016-06-20', '0656 Ortiz Streets Apt. 873 Andersenmouth, NM 95354'),
('Patrick', 'Davis', 'sandymorris@olson.biz', '3696171891', '1926-04-14', '352 David Falls Apt. 976 East Patriciachester, LA 62085'),
('Rebecca', 'Mason', 'williamsryan@watkins.com', '3916961898', '1946-12-07', '50185 Allen Divide Apt. 111 Melissamouth, CT 93445'),
('Lauren', 'George', 'nclark@elliott.com', '+1-541-903-9268x6003', '1919-02-16', '29896 Christopher Mountains Apt. 547 South Nicholas, NH 57140'),
('Thomas', 'Mueller', 'briankent@hotmail.com', '928-146-4942', '1946-10-16', '7811 Harris Glens Apt. 394 West Arthur, SD 19620'),
('Beth', 'Greer', 'mpadilla@gmail.com', '596-536-1090', '1932-03-28', '38973 Lori Valley Apt. 492 West Laurahaven, DC 43905'),
('Troy', 'Montoya', 'brian50@willis.com', '059-588-6413', '2024-03-11', '7607 Amy Plaza Apt. 219 Justinton, NJ 37526'),
('Linda', 'Phillips', 'underwooddenise@navarro.net', '496.193.7354x9616', '1913-06-10', '819 Jacqueline Shoals South Ashleyside, AZ 52643'),
('Kevin', 'Rodriguez', 'emilyhernandez@ortiz.com', '+1-507-033-9818', '1959-04-24', '6317 White Mews Suite 888 Lake Deborah, MS 96636'),
('Shaun', 'Chung', 'melissawhite@hotmail.com', '(443)277-6502x2202', '1994-01-05', '8314 Roy Coves Apt. 254 Gomezshire, OK 50754'),
('Michael', 'Mitchell', 'dustincarroll@lewis.com', '714.626.9275x4357', '1916-03-16', '0039 Savannah Views Suite 852 South Sharon, UT 99232'),
('Philip', 'Davis', 'richardsonkara@davis-morgan.biz', '498.673.8779x65201', '1926-10-14', '379 White Plains Suite 214 South Hunterfurt, NY 32405'),
('Dominique', 'King', 'julia42@rosales.com', '857-765-0819', '1939-07-23', 'Unit 4196 Box 0142 DPO AP 40881'),
('Lauren', 'Fernandez', 'gloria61@yahoo.com', '+1-657-129-3778', '1956-07-02', '1370 Brett Valleys Michealbury, LA 68519'),
('Tammy', 'Moore', 'bennettshelly@hotmail.com', '(589)648-4965', '2022-01-03', '2099 Shaw Highway Apt. 283 Blankenshipfurt, AK 69347'),
('Dylan', 'Salazar', 'pughwilliam@faulkner-boyd.net', '+1-952-153-1505x152', '2019-07-03', '9938 Emma Mountains Suite 916 Robertport, UT 17450'),
('Debra', 'Foster', 'youngjennifer@hotmail.com', '001-548-862-9267x182', '1993-09-16', '040 Brianna Fords Apt. 423 Port Cindyport, KS 71584'),
('Daniel', 'Arnold', 'nsmith@yahoo.com', '001-242-370-9853x7881', '1985-07-31', '738 Hodges Highway Suite 223 Port William, IL 83166'),
('John', 'Jones', 'christopher35@baker.com', '006-456-8533x7718', '2002-01-15', '91252 Gonzalez Summit Williamsmouth, IA 09767'),
('Kenneth', 'Manning', 'michaelcook@hotmail.com', '1696507542', '2013-09-09', '6852 Eric Bypass Apt. 281 Port Jessica, SC 21948');


-- Insert sample data into service_plans
INSERT INTO service_plans (plan_name, monthly_cost, data_limit_gb, voice_minutes, sms_limit) VALUES
('Plan 1', 34.3, 24, 318, 694),
('Plan 2', 31.78, 9, 3433, 865),
('Plan 3', 46.25, 49, 3958, 748),
('Plan 4', 60.95, 83, 4190, 462),
('Plan 5', 78.14, 15, 3442, 287),
('Plan 6', 47.28, 28, 471, 222),
('Plan 7', 26.24, 70, 2043, 810),
('Plan 8', 52.4, 8, 3911, 227),
('Plan 9', 74.73, 33, 4224, 556),
('Plan 10', 53.28, 76, 427, 903),
('Plan 11', 51.88, 42, 4096, 925),
('Plan 12', 78.3, 5, 2546, 774),
('Plan 13', 38.93, 60, 1363, 758),
('Plan 14', 78.72, 55, 3195, 828),
('Plan 15', 42.6, 93, 1275, 392),
('Plan 16', 74.9, 91, 4539, 637),
('Plan 17', 36.89, 10, 3224, 465),
('Plan 18', 29.22, 59, 1824, 711),
('Plan 19', 56.44, 40, 2356, 71),
('Plan 20', 45.26, 83, 1808, 521),
('Plan 21', 36.92, 63, 584, 855),
('Plan 22', 63.38, 2, 1771, 374),
('Plan 23', 30.87, 68, 1653, 770),
('Plan 24', 67.07, 99, 3380, 396),
('Plan 25', 26.03, 2, 3357, 765),
('Plan 26', 65.38, 42, 2092, 942),
('Plan 27', 21.8, 84, 1703, 345),
('Plan 28', 62.08, 93, 3780, 802),
('Plan 29', 60.5, 41, 3702, 695),
('Plan 30', 61.83, 73, 985, 835),
('Plan 31', 71.43, 31, 3506, 284),
('Plan 32', 68.93, 55, 252, 638),
('Plan 33', 71.88, 68, 3393, 789),
('Plan 34', 67.63, 18, 1524, 72),
('Plan 35', 43.43, 49, 2708, 701),
('Plan 36', 41.26, 62, 4626, 54),
('Plan 37', 61.38, 1, 1648, 660),
('Plan 38', 75.63, 71, 3389, 762),
('Plan 39', 38.53, 37, 2452, 594),
('Plan 40', 46.63, 4, 2951, 173),
('Plan 41', 42.11, 87, 2644, 80),
('Plan 42', 41.06, 12, 3020, 446),
('Plan 43', 59.62, 34, 3088, 210),
('Plan 44', 27.08, 17, 3811, 808),
('Plan 45', 25.56, 46, 627, 168),
('Plan 46', 60.1, 87, 1581, 504),
('Plan 47', 38.86, 98, 2090, 208),
('Plan 48', 65.21, 63, 3034, 705),
('Plan 49', 24.53, 38, 1252, 838),
('Plan 50', 69.22, 2, 323, 802);


-- Insert sample data into purchase_info
INSERT INTO purchase_info (customer_id, plan_id, purchase_date, amount_paid, payment_method) VALUES
(31, 36, '2024-08-12', 61.95, 'Credit Card'),
(35, 33, '2024-03-28', 58.1, 'Credit Card'),
(27, 11, '2024-04-14', 63.12, 'Bank Transfer'),
(11, 26, '2024-01-04', 35.6, 'Bank Transfer'),
(2, 18, '2024-05-10', 49.0, 'Bank Transfer'),
(45, 47, '2024-06-12', 72.19, 'Bank Transfer'),
(48, 45, '2024-05-08', 45.59, 'PayPal'),
(49, 45, '2024-09-05', 36.31, 'PayPal'),
(36, 48, '2024-07-01', 57.38, 'Credit Card'),
(25, 5, '2024-06-03', 62.65, 'PayPal'),
(4, 20, '2024-06-26', 50.83, 'Credit Card'),
(16, 20, '2024-04-15', 49.9, 'PayPal'),
(18, 46, '2024-08-06', 20.84, 'PayPal'),
(37, 43, '2024-02-18', 58.68, 'PayPal'),
(11, 48, '2024-06-09', 36.43, 'Bank Transfer'),
(21, 34, '2024-02-29', 35.09, 'PayPal'),
(38, 35, '2024-04-17', 78.48, 'PayPal'),
(11, 26, '2024-09-25', 22.89, 'Bank Transfer'),
(7, 45, '2024-07-14', 52.71, 'PayPal'),
(21, 34, '2024-07-29', 54.41, 'Credit Card'),
(16, 28, '2024-03-02', 45.4, 'Credit Card'),
(34, 7, '2024-02-10', 71.13, 'Credit Card'),
(42, 45, '2024-01-25', 31.62, 'Bank Transfer'),
(15, 20, '2024-03-21', 42.95, 'Bank Transfer'),
(23, 31, '2024-05-25', 66.97, 'Credit Card'),
(2, 31, '2024-01-23', 79.98, 'Credit Card'),
(31, 17, '2024-02-06', 27.75, 'Credit Card'),
(3, 31, '2024-01-12', 48.64, 'Bank Transfer'),
(47, 13, '2024-02-21', 33.95, 'Bank Transfer'),
(41, 24, '2024-09-19', 67.45, 'PayPal'),
(26, 7, '2024-09-27', 77.2, 'Bank Transfer'),
(3, 2, '2024-08-24', 78.99, 'Bank Transfer'),
(37, 21, '2024-10-08', 54.4, 'Bank Transfer'),
(35, 3, '2024-08-10', 74.12, 'Bank Transfer'),
(34, 14, '2024-06-23', 21.86, 'PayPal'),
(3, 45, '2024-03-11', 62.6, 'PayPal'),
(32, 12, '2024-02-12', 19.99, 'Bank Transfer'),
(36, 19, '2024-01-28', 49.93, 'Credit Card'),
(11, 36, '2024-09-07', 30.91, 'Credit Card'),
(33, 46, '2024-08-24', 69.48, 'Bank Transfer'),
(6, 33, '2024-08-01', 60.69, 'PayPal'),
(6, 37, '2024-07-01', 40.82, 'Bank Transfer'),
(20, 12, '2024-04-22', 37.83, 'PayPal'),
(31, 21, '2024-09-30', 46.88, 'Bank Transfer'),
(49, 48, '2024-07-20', 38.16, 'PayPal'),
(5, 18, '2024-09-04', 35.82, 'PayPal'),
(34, 4, '2024-03-13', 63.06, 'Credit Card'),
(35, 19, '2024-08-04', 28.26, 'Credit Card'),
(24, 36, '2024-08-12', 38.11, 'PayPal'),
(48, 35, '2024-10-07', 54.76, 'Bank Transfer');


-- Insert sample data into call_data_records
INSERT INTO call_data_records (customer_id, start_time, end_time, origin, destination, call_duration, call_cost) VALUES
(1, '2024-04-16 20:58:06', '2024-05-04 21:02:59', '595-898-3808x963', '001-700-825-0718x38604', 2487, 44.99),
(48, '2024-07-04 21:45:22', '2024-08-19 15:07:28', '(706)024-1538x3012', '769.200.5537', 1411, 17.64),
(29, '2024-09-30 22:28:51', '2024-06-20 05:58:48', '996-813-4197x7204', '001-719-167-5836x240', 1565, 46.55),
(50, '2024-08-28 18:45:00', '2024-06-04 19:09:59', '+1-889-620-8735x1985', '710-760-3174x34148', 2620, 2.21),
(37, '2024-07-12 17:21:12', '2024-01-28 06:29:54', '715-593-0574x0122', '206-484-7237x7914', 2377, 32.15),
(20, '2024-04-25 01:07:08', '2024-02-05 21:06:44', '709-028-4766x774', '9389653135', 2151, 14.83),
(7, '2024-06-26 11:20:30', '2024-08-25 21:31:08', '177-375-2796x3126', '(795)369-4209x743', 2572, 2.13),
(24, '2024-03-15 06:40:44', '2024-04-28 03:08:11', '066.077.5349', '+1-871-119-8133', 938, 9.95),
(15, '2024-08-29 14:15:44', '2024-07-18 17:51:29', '(780)480-7582x62141', '(900)678-0302', 1890, 38.3),
(44, '2024-06-16 06:51:46', '2024-03-05 10:22:52', '830.865.0987x9801', '142.351.2442x77708', 559, 4.92),
(35, '2024-07-02 03:02:45', '2024-08-11 17:51:06', '277-357-8157', '+1-817-360-6795x4282', 162, 25.23),
(49, '2024-02-20 23:53:41', '2024-04-07 14:46:13', '711-542-4981x4802', '(550)893-1554x03723', 2744, 17.68),
(11, '2024-03-11 05:17:03', '2024-04-10 13:41:00', '155.939.6664', '8272110283', 378, 11.9),
(40, '2024-01-01 16:14:53', '2024-05-27 18:13:25', '001-873-462-3548x88387', '136.927.1755', 2306, 46.26),
(33, '2024-02-11 16:37:09', '2024-05-13 07:57:53', '017.843.1644', '001-300-795-1026x33834', 2086, 34.45),
(17, '2024-07-17 06:10:28', '2024-06-17 12:35:54', '(617)813-6927', '995-935-3013', 2436, 46.7),
(37, '2024-06-30 19:45:16', '2024-01-10 20:53:00', '996.853.7611', '528.103.4058x14336', 607, 43.74),
(47, '2024-01-24 06:43:55', '2024-04-13 16:31:01', '441.290.2318x2050', '(081)348-6168', 207, 6.97),
(25, '2024-03-12 08:40:37', '2024-02-25 20:29:06', '+1-622-610-7178x21939', '197.081.0560', 104, 29.76),
(16, '2024-02-07 11:19:23', '2024-10-01 21:41:37', '(285)418-8603', '451.795.2852x826', 2304, 3.86),
(8, '2024-05-24 18:34:51', '2024-01-07 12:09:37', '+1-731-647-1038x439', '080-907-8154x29144', 462, 22.06),
(38, '2024-07-26 17:10:12', '2024-08-01 15:34:28', '410.831.9647x3009', '975.850.3365', 378, 38.33),
(23, '2024-05-15 02:34:23', '2024-01-19 17:03:59', '026.313.6340x82853', '430-238-7735x403', 341, 43.17),
(31, '2024-05-03 00:01:30', '2024-03-11 02:33:10', '021-703-3843', '+1-835-704-6994x3789', 1548, 23.24),
(18, '2024-06-02 08:33:16', '2024-08-01 18:19:56', '(396)635-3121', '(528)378-9638x2318', 1550, 3.99),
(27, '2024-06-21 11:31:53', '2024-07-23 14:24:01', '485-984-4363x9109', '609.419.3179', 2420, 16.0),
(27, '2024-05-29 06:17:05', '2024-10-04 23:25:58', '284-771-2059', '(321)308-4511', 316, 17.66),
(23, '2024-01-01 23:48:03', '2024-02-12 14:01:29', '001-158-322-2685x450', '211.864.4300', 860, 5.14),
(50, '2024-05-14 10:44:30', '2024-01-10 05:59:11', '6591354748', '+1-180-310-3987x13500', 1511, 28.23),
(10, '2024-03-26 09:43:21', '2024-07-11 17:11:29', '+1-429-669-2958x6508', '001-952-615-4608x629', 1837, 34.99),
(40, '2024-06-21 14:20:43', '2024-02-09 18:16:54', '(261)692-8641x8614', '(427)774-8162x11271', 1257, 27.61),
(32, '2024-08-16 20:06:51', '2024-10-01 21:37:33', '(891)948-4201x97117', '001-475-022-4233x9608', 1470, 47.35),
(42, '2024-03-15 02:07:59', '2024-06-25 04:54:27', '001-808-175-0614x3518', '001-974-717-7929', 896, 17.45),
(34, '2024-06-21 11:00:20', '2024-07-25 01:10:43', '981-684-3173x73480', '001-202-349-3741x4002', 328, 40.44),
(21, '2024-06-02 08:45:08', '2024-02-18 14:48:43', '001-171-416-5782', '(793)058-0030x70208', 1659, 46.19),
(50, '2024-01-30 13:45:57', '2024-07-30 18:58:37', '001-637-417-5861x7577', '001-790-324-8569x766', 336, 41.81),
(49, '2024-03-26 22:32:07', '2024-03-28 04:12:57', '(378)993-9081', '(268)529-5203', 2508, 25.64),
(36, '2024-03-17 12:33:13', '2024-07-02 05:00:20', '001-668-425-0305x0947', '4803982479', 606, 9.69),
(17, '2024-02-27 07:49:39', '2024-06-12 03:14:11', '(570)869-7111x438', '357.066.5173x289', 1332, 6.67),
(23, '2024-05-02 00:14:22', '2024-04-06 04:06:35', '115.900.4614x572', '236-423-8229x02477', 2654, 26.37),
(21, '2024-09-29 18:11:53', '2024-06-23 08:07:19', '871.049.5047', '106.878.9914x63957', 1134, 43.32),
(37, '2024-01-02 22:30:28', '2024-06-27 00:35:28', '251-951-3064', '831.655.3558x64134', 1044, 45.82),
(11, '2024-04-07 21:28:43', '2024-01-08 06:11:39', '+1-433-934-1236x383', '(886)082-4440x8408', 472, 43.15),
(40, '2024-08-06 07:18:49', '2024-09-24 05:12:46', '001-942-855-8411', '187-897-7697', 2150, 29.63),
(11, '2024-08-01 23:09:18', '2024-09-11 08:39:08', '+1-631-621-4262x8759', '+1-740-495-8498', 1187, 18.84),
(30, '2024-08-09 16:41:37', '2024-01-04 16:15:54', '+1-271-996-4954', '091-009-0047', 1114, 24.38),
(3, '2024-09-04 19:13:54', '2024-03-23 22:21:47', '444.280.5691', '5058985623', 401, 30.48),
(16, '2024-04-13 15:54:17', '2024-01-17 13:04:04', '5515070618', '001-843-728-8833x29079', 1045, 22.95),
(14, '2024-09-09 22:15:03', '2024-07-14 06:12:52', '001-474-009-8833x313', '+1-909-756-3792x311', 1892, 3.64),
(35, '2024-02-28 13:19:38', '2024-03-08 18:12:00', '+1-458-223-9008x11482', '+1-744-023-3149x969', 46, 36.5);